"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[691],{3905:(e,t,a)=>{a.d(t,{Zo:()=>p,kt:()=>A});var r=a(67294);function n(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function l(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function o(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?l(Object(a),!0).forEach((function(t){n(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):l(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function s(e,t){if(null==e)return{};var a,r,n=function(e,t){if(null==e)return{};var a,r,n={},l=Object.keys(e);for(r=0;r<l.length;r++)a=l[r],t.indexOf(a)>=0||(n[a]=e[a]);return n}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(r=0;r<l.length;r++)a=l[r],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}var i=r.createContext({}),u=function(e){var t=r.useContext(i),a=t;return e&&(a="function"==typeof e?e(t):o(o({},t),e)),a},p=function(e){var t=u(e.components);return r.createElement(i.Provider,{value:t},e.children)},d="mdxType",m={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},N=r.forwardRef((function(e,t){var a=e.components,n=e.mdxType,l=e.originalType,i=e.parentName,p=s(e,["components","mdxType","originalType","parentName"]),d=u(a),N=n,A=d["".concat(i,".").concat(N)]||d[N]||m[N]||l;return a?r.createElement(A,o(o({ref:t},p),{},{components:a})):r.createElement(A,o({ref:t},p))}));function A(e,t){var a=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var l=a.length,o=new Array(l);o[0]=N;var s={};for(var i in t)hasOwnProperty.call(t,i)&&(s[i]=t[i]);s.originalType=e,s[d]="string"==typeof e?e:n,o[1]=s;for(var u=2;u<l;u++)o[u]=a[u];return r.createElement.apply(null,o)}return r.createElement.apply(null,a)}N.displayName="MDXCreateElement"},87622:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>i,contentTitle:()=>o,default:()=>d,frontMatter:()=>l,metadata:()=>s,toc:()=>u});var r=a(87462),n=(a(67294),a(3905));const l={},o="BLOQUEIO CADASTROS",s={unversionedId:"Processos/bloqueio_cadastros",id:"Processos/bloqueio_cadastros",title:"BLOQUEIO CADASTROS",description:"Idealizador: Jonathan Torioni",source:"@site/docs/5-Processos/bloqueio_cadastros.md",sourceDirName:"5-Processos",slug:"/Processos/bloqueio_cadastros",permalink:"/docushark/docs/Processos/bloqueio_cadastros",draft:!1,tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Acerto de Custo Kardex",permalink:"/docushark/docs/Processos/acerto_de_custo"},next:{title:"Documenta\xe7\xe3o - Integra\xe7\xe3o CUSTOMERS B2B SK",permalink:"/docushark/docs/Processos/custumers_b2b_sk"}},i={},u=[{value:"Objetivo",id:"objetivo",level:2},{value:"Regras",id:"regras",level:2},{value:"Produtos",id:"produtos",level:3},{value:"Clientes",id:"clientes",level:3},{value:"Fornecedores",id:"fornecedores",level:3},{value:"Fontes",id:"fontes",level:2},{value:"Views",id:"views",level:2},{value:"Querys",id:"querys",level:2},{value:"Selecao produtos para bloqueio",id:"selecao-produtos-para-bloqueio",level:3},{value:"Sele\xe7\xe3o clientes para bloqueio",id:"sele\xe7\xe3o-clientes-para-bloqueio",level:3},{value:"Tabelas",id:"tabelas",level:2},{value:"Tabela de logs de bloqueios",id:"tabela-de-logs-de-bloqueios",level:3},{value:"Log de produtos",id:"log-de-produtos",level:4},{value:"Log de clientes",id:"log-de-clientes",level:4},{value:"Log de fornecedores",id:"log-de-fornecedores",level:4}],p={toc:u};function d(e){let{components:t,...a}=e;return(0,n.kt)("wrapper",(0,r.Z)({},p,a,{components:t,mdxType:"MDXLayout"}),(0,n.kt)("h1",{id:"bloqueio-cadastros"},"BLOQUEIO CADASTROS"),(0,n.kt)("p",null,"Idealizador: Jonathan Torioni"),(0,n.kt)("p",null,"Data de cria\xe7\xe3\xf5: 22/10/2025"),(0,n.kt)("hr",null),(0,n.kt)("h2",{id:"objetivo"},"Objetivo"),(0,n.kt)("p",null,"Rotina de execu\xe7\xe3o autom\xe1tica para bloqueio de cadastros n\xe3o utilizados."),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},"Cadastros:")),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"Produtos"),(0,n.kt)("li",{parentName:"ul"},"Clientes"),(0,n.kt)("li",{parentName:"ul"},"Fornecedores")),(0,n.kt)("hr",null),(0,n.kt)("h2",{id:"regras"},"Regras"),(0,n.kt)("h3",{id:"produtos"},"Produtos"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"Aus\xeancia total de estoque (Qualquer tipo, incluindo BO)"),(0,n.kt)("li",{parentName:"ul"},"N\xe3o possuir v\xednculo com OS em aberto"),(0,n.kt)("li",{parentName:"ul"},"Cadastro criado h\xe1 36 meses ou mais"),(0,n.kt)("li",{parentName:"ul"},"Sem movimento (Entrada, saida, devolu\xe7\xe3o ou transfer\xeancia) por 36 meses ou mais")),(0,n.kt)("h3",{id:"clientes"},"Clientes"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"Cadastri com status inativo"),(0,n.kt)("li",{parentName:"ul"},"Inexist\xeancia de t\xedtulos em aberto (qualquer natureza e financeiro)"),(0,n.kt)("li",{parentName:"ul"},"Aus\xeancia de registros de negativa\xe7\xe3o"),(0,n.kt)("li",{parentName:"ul"},"Cadastro criado h\xe1 36 meses ou mais"),(0,n.kt)("li",{parentName:"ul"},"Sem movimenta\xe7\xe3o (venda, devolu\xe7\xe3o) por 36 meses ou mais")),(0,n.kt)("h3",{id:"fornecedores"},"Fornecedores"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"Sem estoque vinculado (qualquer tipo, incluindo BO)"),(0,n.kt)("li",{parentName:"ul"},"Inexist\xeancia de t\xedtulos em aberto (Qualquer natureza)"),(0,n.kt)("li",{parentName:"ul"},"N\xe3o possuir processo de garantia ou devolu\xe7\xe3o em andamento"),(0,n.kt)("li",{parentName:"ul"},"Cadastro criado h\xe1 36 meses ou mais")),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},"Obs: A empresa Moreia n\xe3o ser\xe1 incluida neste processo inicialmente.")),(0,n.kt)("hr",null),(0,n.kt)("h2",{id:"fontes"},"Fontes"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("strong",{parentName:"li"},"viewb1040.prw")," - Respons\xe1vel por realizar a cria\xe7\xe3o das views referente ao bloqueio de cadastro dos produtos."),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("strong",{parentName:"li"},"shblqprd.prw")," - Fonte respons\xe1vel por bloquear itens do cadastro de produto e armazenar o log do bloqueio."),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("strong",{parentName:"li"},"shblqcli.prw")," - Fonte respons\xe1vel por bloquear itens do cadastro de clientes e armazenar o log do bloqueio."),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("strong",{parentName:"li"},"shblqfor.prw")," - Fonte respons\xe1vel por bloquear itens do cadastro de fornecedores e armazenar o log do bloqueio.")),(0,n.kt)("hr",null),(0,n.kt)("h2",{id:"views"},"Views"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("strong",{parentName:"li"},"V_ULT_MOV_SB1040")," - View respons\xe1vel por apresentar o ultimo movimento de qualquer produto cadastrado na SB1040"),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("strong",{parentName:"li"},"V_PROD_VIC_OS_SB1040")," - View respons\xe1vel por apresentar todos os produtos que possuem vinculo com OS em abertos, somente produtos cadastrados na SB1040"),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("strong",{parentName:"li"},"V_PROD_BO_SB1040")," - View respons\xe1vel por apresentar todos os produtos da sb1040 que possuem processo de BO em aberto."),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("strong",{parentName:"li"},"V_ULT_MOV_SB1060")," - View respons\xe1vel por apresentar o ultimo movimento de qualquer produto cadastrado na SB1060"),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("strong",{parentName:"li"},"V_PROD_VIC_OS_SB1060")," - View respons\xe1vel por apresentar todos os produtos que possuem vinculo com OS em abertos, somente produtos cadastrados na SB1060"),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("strong",{parentName:"li"},"V_PROD_BO_SB1060")," - View respons\xe1vel por apresentar todos os produtos da sb1060 que possuem processo de BO em aberto."),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("strong",{parentName:"li"},"VIEWSLD_01_03_04_08_11_24_25")," - View de saldos dos produtos, Tratores, Equagril, Agricase, SSA, Nova Holanda, Disma, Agriparts"),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("strong",{parentName:"li"},"VIEWSLD_01_03_04_08_11_23_24_25")," - View de saldos dos produtos, Tratores, Equagril, Agricase, SSA, Nova Holanda, Moreia, Disma, Agriparts"),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("strong",{parentName:"li"},"VIEW_TITULOS_ABERTOS")," - View respons\xe1vel por apresentar clientes com titulos(saldos) em aberto em todas as empresas ou somente SK"),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("strong",{parentName:"li"},"VIEW_TITULOS_ABERTOS_FORNECEDOR")," - View respons\xe1vel por apresentar fornecedores com titulos(saldos) em aberto em todas as empresas ou somente SK")),(0,n.kt)("hr",null),(0,n.kt)("h2",{id:"querys"},"Querys"),(0,n.kt)("h3",{id:"selecao-produtos-para-bloqueio"},"Selecao produtos para bloqueio"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-sql"},"--As datas na query sao atualizadas conforme o dia do processamento\nSELECT \nBASE3.B1_COD,\nBASE3.DATA_INC,\nBASE3.DATA_ULT_MOV\nFROM\n(SELECT \nBASE2.B1_COD,\nBASE2.DATA_INC,\n(SELECT MAX(ULTIMA_DATA) FROM V_ULT_MOV_SB1040 WHERE B2_COD = BASE2.B1_COD) AS DATA_ULT_MOV --Busca ultima movimentacao do produto\nFROM\n(SELECT \nBASE.B1_COD,\nBASE.DATA_INC\nFROM\n(SELECT \nB1_COD,\nTO_CHAR(TO_DATE('1996-01-01', 'YYYY-MM-DD') + (CAST((ASCII(SUBSTR(B1_USERLGI, 12, 1)) - 50) || (ASCII(SUBSTR(B1_USERLGI, 16, 1)) - 50) AS INT) + CASE WHEN SUBSTR(B1_USERLGI, 8, 1) = '<' THEN 10000 ELSE 0 END),'YYYYMMDD') as DATA_INC\nFROM SB1040 SB1\nWHERE B1_FILIAL = ' '\nAND B1_MSBLQL = '2'\nAND B1_TIPO = 'ME'\nAND B1_USERLGI NOT LIKE '%COREMA%'\nAND B1_USERLGI NOT LIKE '%      %'\nAND SB1.D_E_L_E_T_ = ' ')BASE\nWHERE BASE.DATA_INC <= '20221017')BASE2)BASE3\nWHERE (BASE3.DATA_ULT_MOV IS NULL\nOR BASE3.DATA_ULT_MOV <= '20221017'\nOR BASE3.DATA_ULT_MOV = ' ')\nAND NOT EXISTS (SELECT 'Y' FROM V_PROD_VIC_OS_SB1040 WHERE PRODUTO_EM_OS = BASE3.B1_COD) --Descarta produtos com vinculos em OS\nAND NOT EXISTS (SELECT 'Y' FROM V_PROD_BO_SB1040 WHERE C7_PRODUTO = BASE3.B1_COD) --Descarta produtos que possuem BO em aberto\n")),(0,n.kt)("h3",{id:"sele\xe7\xe3o-clientes-para-bloqueio"},"Sele\xe7\xe3o clientes para bloqueio"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-sql"},"--As datas na query sao atualizadas conforme o dia do processamento\nSELECT\nAMOSTRA.A1_COD,\nAMOSTRA.A1_LOJA,\nAMOSTRA.A1_NOME,\nAMOSTRA.A1_ULTCOM,\nAMOSTRA.DATA_INC\nFROM\n(SELECT \nA1_COD, \nA1_LOJA,\nA1_NOME,\nA1_ULTCOM,\nTO_CHAR(TO_DATE('1996-01-01', 'YYYY-MM-DD') + (CAST((ASCII(SUBSTR(A1_USERLGI, 12, 1)) - 50) || (ASCII(SUBSTR(A1_USERLGI, 16, 1)) - 50) AS INT) + CASE WHEN SUBSTR(A1_USERLGI, 8, 1) = '<' THEN 10000 ELSE 0 END),'YYYYMMDD') as DATA_INC\nFROM SA1080 SA1\nWHERE A1_FILIAL = ' '\nAND A1_MSBLQL = '2'\nAND A1_XBLFAT = 'I'\nAND A1_XEMPGRU <> '1'\nAND A1_RISCO <> 'A'\nAND A1_ULTCOM <= '20221027'\nAND A1_USERLGI NOT LIKE '%      %'\nAND NOT EXISTS (SELECT 'Y' FROM SZPG01 SZP\n                       WHERE ZP_FILIAL = ' '\n                       AND ZP_CGC = A1_CGC\n                       AND ZP_ATIVA = 'S'\n                       AND SZP.D_E_L_E_T_ = ' ')\nAND SA1.D_E_L_E_T_ = ' '\nAND NOT EXISTS (SELECT 'Y' FROM VIEW_TITULOS_ABERTOS\n                WHERE EMP IN ('01','08')\n                AND E1_CLIENTE = A1_COD\n                AND E1_LOJA = A1_LOJA)\n)AMOSTRA\nWHERE AMOSTRA.DATA_INC <= '20221027'\n")),(0,n.kt)("hr",null),(0,n.kt)("h2",{id:"tabelas"},"Tabelas"),(0,n.kt)("h3",{id:"tabela-de-logs-de-bloqueios"},"Tabela de logs de bloqueios"),(0,n.kt)("h4",{id:"log-de-produtos"},"Log de produtos"),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},"SB1_LOG_BLOQUEIOS")),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",{parentName:"tr",align:null},"CAMPOS"),(0,n.kt)("th",{parentName:"tr",align:null},"TAMANHO"),(0,n.kt)("th",{parentName:"tr",align:null},"RESTRICAO"))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:null},"TABELA"),(0,n.kt)("td",{parentName:"tr",align:null},"10"),(0,n.kt)("td",{parentName:"tr",align:null},"NOT NULL")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:null},"PRODUTO"),(0,n.kt)("td",{parentName:"tr",align:null},"27"),(0,n.kt)("td",{parentName:"tr",align:null},"NOT NULL")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:null},"DATA_CADASTRO"),(0,n.kt)("td",{parentName:"tr",align:null},"8"),(0,n.kt)("td",{parentName:"tr",align:null})),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:null},"DATA_ULT_MOV"),(0,n.kt)("td",{parentName:"tr",align:null},"8"),(0,n.kt)("td",{parentName:"tr",align:null})),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:null},"DATA_BLOQ"),(0,n.kt)("td",{parentName:"tr",align:null},"8"),(0,n.kt)("td",{parentName:"tr",align:null},"NOT NULL")))),(0,n.kt)("h4",{id:"log-de-clientes"},"Log de clientes"),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},"SA1_LOG_BLOQUEIOS")),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",{parentName:"tr",align:null},"CAMPOS"),(0,n.kt)("th",{parentName:"tr",align:null},"TAMANHO"),(0,n.kt)("th",{parentName:"tr",align:null},"RESTRICAO"))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:null},"TABELA"),(0,n.kt)("td",{parentName:"tr",align:null},"10"),(0,n.kt)("td",{parentName:"tr",align:null},"NOT NULL")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:null},"CLIENTE"),(0,n.kt)("td",{parentName:"tr",align:null},"06"),(0,n.kt)("td",{parentName:"tr",align:null},"NOT NULL")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:null},"LOJA"),(0,n.kt)("td",{parentName:"tr",align:null},"02"),(0,n.kt)("td",{parentName:"tr",align:null},"NOT NULL")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:null},"DATA_CADASTRO"),(0,n.kt)("td",{parentName:"tr",align:null},"8"),(0,n.kt)("td",{parentName:"tr",align:null})),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:null},"DATA_ULT_COMPRA"),(0,n.kt)("td",{parentName:"tr",align:null},"8"),(0,n.kt)("td",{parentName:"tr",align:null})),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:null},"DATA_BLOQ"),(0,n.kt)("td",{parentName:"tr",align:null},"8"),(0,n.kt)("td",{parentName:"tr",align:null},"NOT NULL")))),(0,n.kt)("h4",{id:"log-de-fornecedores"},"Log de fornecedores"),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},"SA2_LOG_BLOQUEIOS")),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",{parentName:"tr",align:null},"CAMPOS"),(0,n.kt)("th",{parentName:"tr",align:null},"TAMANHO"),(0,n.kt)("th",{parentName:"tr",align:null},"RESTRICAO"))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:null},"TABELA"),(0,n.kt)("td",{parentName:"tr",align:null},"10"),(0,n.kt)("td",{parentName:"tr",align:null},"NOT NULL")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:null},"FORNECEDOR"),(0,n.kt)("td",{parentName:"tr",align:null},"06"),(0,n.kt)("td",{parentName:"tr",align:null},"NOT NULL")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:null},"LOJA"),(0,n.kt)("td",{parentName:"tr",align:null},"02"),(0,n.kt)("td",{parentName:"tr",align:null},"NOT NULL")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:null},"DATA_CADASTRO"),(0,n.kt)("td",{parentName:"tr",align:null},"8"),(0,n.kt)("td",{parentName:"tr",align:null})),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:null},"DATA_BLOQ"),(0,n.kt)("td",{parentName:"tr",align:null},"8"),(0,n.kt)("td",{parentName:"tr",align:null},"NOT NULL")))))}d.isMDXComponent=!0}}]);