"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[3728],{3905:(e,a,t)=>{t.d(a,{Zo:()=>m,kt:()=>k});var r=t(67294);function o(e,a,t){return a in e?Object.defineProperty(e,a,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[a]=t,e}function n(e,a){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);a&&(r=r.filter((function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable}))),t.push.apply(t,r)}return t}function p(e){for(var a=1;a<arguments.length;a++){var t=null!=arguments[a]?arguments[a]:{};a%2?n(Object(t),!0).forEach((function(a){o(e,a,t[a])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):n(Object(t)).forEach((function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(t,a))}))}return e}function l(e,a){if(null==e)return{};var t,r,o=function(e,a){if(null==e)return{};var t,r,o={},n=Object.keys(e);for(r=0;r<n.length;r++)t=n[r],a.indexOf(t)>=0||(o[t]=e[t]);return o}(e,a);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);for(r=0;r<n.length;r++)t=n[r],a.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(o[t]=e[t])}return o}var s=r.createContext({}),i=function(e){var a=r.useContext(s),t=a;return e&&(t="function"==typeof e?e(a):p(p({},a),e)),t},m=function(e){var a=i(e.components);return r.createElement(s.Provider,{value:a},e.children)},u="mdxType",d={inlineCode:"code",wrapper:function(e){var a=e.children;return r.createElement(r.Fragment,{},a)}},c=r.forwardRef((function(e,a){var t=e.components,o=e.mdxType,n=e.originalType,s=e.parentName,m=l(e,["components","mdxType","originalType","parentName"]),u=i(t),c=o,k=u["".concat(s,".").concat(c)]||u[c]||d[c]||n;return t?r.createElement(k,p(p({ref:a},m),{},{components:t})):r.createElement(k,p({ref:a},m))}));function k(e,a){var t=arguments,o=a&&a.mdxType;if("string"==typeof e||o){var n=t.length,p=new Array(n);p[0]=c;var l={};for(var s in a)hasOwnProperty.call(a,s)&&(l[s]=a[s]);l.originalType=e,l[u]="string"==typeof e?e:o,p[1]=l;for(var i=2;i<n;i++)p[i]=t[i];return r.createElement.apply(null,p)}return r.createElement.apply(null,t)}c.displayName="MDXCreateElement"},54050:(e,a,t)=>{t.r(a),t.d(a,{assets:()=>s,contentTitle:()=>p,default:()=>u,frontMatter:()=>n,metadata:()=>l,toc:()=>i});var r=t(87462),o=(t(67294),t(3905));const n={},p="BRWPBV.PRW",l={unversionedId:"Fontes/brwpbv",id:"Fontes/brwpbv",title:"BRWPBV.PRW",description:"Idealizador: Fernando Carvalho",source:"@site/docs/2-Fontes/brwpbv.md",sourceDirName:"2-Fontes",slug:"/Fontes/brwpbv",permalink:"/docushark/docs/Fontes/brwpbv",draft:!1,tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"APIPIXBB.PRW",permalink:"/docushark/docs/Fontes/apipixbb"},next:{title:"CCXFUN.PRW",permalink:"/docushark/docs/Fontes/ccxfun"}},s={},i=[{value:"Objetivo",id:"objetivo",level:2},{value:"Tabelas",id:"tabelas",level:2},{value:"Fun\xe7\xf5es",id:"fun\xe7\xf5es",level:2},{value:"Novos campos",id:"novos-campos",level:2}],m={toc:i};function u(e){let{components:a,...t}=e;return(0,o.kt)("wrapper",(0,r.Z)({},m,t,{components:a,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"brwpbvprw"},"BRWPBV.PRW"),(0,o.kt)("p",null,"Idealizador: Fernando Carvalho"),(0,o.kt)("p",null,"Colaboradores: Lucas Graglia, Jonathan Torioni"),(0,o.kt)("p",null,"Data de cria\xe7\xe3\xf5: 27/06/2023"),(0,o.kt)("hr",null),(0,o.kt)("h2",{id:"objetivo"},"Objetivo"),(0,o.kt)("hr",null),(0,o.kt)("h2",{id:"tabelas"},"Tabelas"),(0,o.kt)("p",null,"Tabelas envolvidas no processo de forma\xe7\xe3\xf5 de pre\xe7os, descri\xe7\xf5es retiradas do dicion\xe1rio SX2."),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"ZDH")," - Cadastro de promo\xe7\xf5es"),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"PVF")," - Pre\xe7o de venda final aplicado"),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"PVB")," - Pre\xe7o de venda base"),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"PBV")," - Calculo PBV SK"),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"PCY")," - Pre\xe7o para ecommerce"),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"PBQ")," - Regras PBV (Royalties)"),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"ZCT")," - Cadastro de markup"),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"PVY")," - Memoria de calculo PVB")),(0,o.kt)("hr",null),(0,o.kt)("h2",{id:"fun\xe7\xf5es"},"Fun\xe7\xf5es"),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("strong",{parentName:"p"},"U_BRWPBV")," - Pre\xe7o base venda -sk")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("strong",{parentName:"p"},"MENUDEF")," - Montagem do menu tela MVC")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("strong",{parentName:"p"},"MONTAFIL")," - Montagem de array com as filiais, cada posi\xe7\xe3o do array\nse refere a uma uf, seu conteudo j\xe1 \xe9 formatado como IN para select")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("strong",{parentName:"p"},"U_FLOADDATA")," - Fun\xe7\xe3o respons\xe1vel por formar o pre\xe7o base de venda.\nA cada execu\xe7\xe3o recalcula toda a entrada da mercadoria\nformando novamente o PBV")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("strong",{parentName:"p"},"U_BRWPBVAT")," - Fun\xe7\xe3o respons\xe1vel por executar a a\xe7\xe3o do usu\xe1rio\nao clicar no bot\xe3o CalcularCV, tamb\xe9m \xe9 respons\xe1vel por\ncoletar os inputs fornecidos pelos usu\xe1rios")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("strong",{parentName:"p"},"U_PROCEST")," - Fun\xe7\xe3o respons\xe1vel por orquestrar a chamada das\nprincipais fun\xe7\xf5es de forma\xe7\xe3o do PBV")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("strong",{parentName:"p"},"U_CONTCALC")," - Fun\xe7\xe3o de execu\xe7\xe3o restrita, somente o analista de TI pode ter acesso.\nFor\xe7a a execu\xe7\xe3o somente da segunda etapa do calculo do PBV")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("strong",{parentName:"p"},"U_APLIPBV")," - Fun\xe7\xe3o orquestradora da aplica\xe7\xe3o dos PBV's calculados na tabela PVF,\nseu uso \xe9 dentro do menu da rotina ou atrav\xe9s dos processamentos\nMKP e Schedule")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("strong",{parentName:"p"},"U_PSP178APL")," - Fun\xe7\xe3o respons\xe1vel por efetivamente gravar os valores processados\nlevando os dados da tabela PVB para a tabela PVF e SBZ")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("strong",{parentName:"p"},"LOCALIZAPAR")," - Fun\xe7\xe3o respons\xe1vel por localizar par\xe2metros espec\xedficos em um vetor\ncontendo diversos par\xe2metros da rotina. Evitando acesso em disco")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("strong",{parentName:"p"},"U_PROCESCALC")," - Processamento do calculo para forma\xe7\xe3o de pre\xe7o final, quando existe\najustes manuais nas regras.")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("strong",{parentName:"p"},"RETREGRAS")," - Fun\xe7\xe3o respons\xe1vel por retornar as regras previamente cadastradas\npelos usu\xe1rios. Regras para a forma\xe7\xe3o dos pre\xe7o")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("strong",{parentName:"p"},"U_CALCPVF")," - Fun\xe7\xe3o respons\xe1vel por executar a segunda parte do calculo de PBV.\nEssa fun\xe7\xe3o utiliza os valores previamente calculados pela fun\xe7\xe3o\nfLoadData e em cima dos valores aplica os fatores, regras, markup e descontos.")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("strong",{parentName:"p"},"U_MEMOCALC")," - Fun\xe7\xe3o respons\xe1vel por acionar a tela de mem\xf3ria de calculo.\nAcionada pelo usu\xe1rio.")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("strong",{parentName:"p"},"SKPBVMEM")," - Fun\xe7\xe3o que realiza a montagem da interface de mem\xf3ria de calculo.")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("strong",{parentName:"p"},"SP178LEG")," - Fun\xe7\xe3o respons\xe1vel por montar a tela de exibi\xe7\xe3o das legendas")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("strong",{parentName:"p"},"FLISTMEM")," - Fun\xe7\xe3o respons\xe1vel por montar os dados que ser\xe3o exibidos\nna tela de mem\xf3ria de calculo.")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("strong",{parentName:"p"},"SP178HIST")," - Fun\xe7\xe3o respons\xe1vel por gravar a mem\xf3ria de calculo na tabela PVY")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("strong",{parentName:"p"},"TRADUZREGRA")," - Fun\xe7\xe3o respons\xe1vel por traduzir as regras para os usu\xe1rios\nevitando passar operadores l\xf3gicos ou nome de campos e tabelas.")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("strong",{parentName:"p"},"ICONEMEM")," - Fun\xe7\xe3o respons\xe1vel por retornar \xedcones de opera\xe7\xe3o\nna tela de memoria de c\xe1lculo.")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("strong",{parentName:"p"},"U_PVBFBAT")," - Fun\xe7\xe3o respons\xe1vel por criar tela de regra para carca\xe7as de bateria.\nO valor informado \xe9 preenchido no par\xe2metro ES_BLKGBAT")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("strong",{parentName:"p"},"U_PVBPLAN")," - Fun\xe7\xe3o de acionamento via usu\xe1rio, respons\xe1vel por processar a importa\xe7\xe3o\nde planilha de PBV ou Markup")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("strong",{parentName:"p"},"IMPORTARQ")," - Fun\xe7\xe3o orquestradora da importa\xe7\xe3o de planilha PBV ou Markup")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("strong",{parentName:"p"},"PROCPBV")," - Fun\xe7\xe3o respons\xe1vel por importar e processar somente a planilha de PBV")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("strong",{parentName:"p"},"U_ATUPVB")," - Fun\xe7\xe3o respons\xe1vel por efetivar o processamento da planilha PBV")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("strong",{parentName:"p"},"PROCMARKUP")," - Fun\xe7\xe3o respons\xe1vel por importar e processar somente a planilha de markup")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("strong",{parentName:"p"},"VLDCARCACA")," - Fun\xe7\xe3o de valida\xe7\xe3o das regras de carca\xe7a de bateria")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("strong",{parentName:"p"},"U_CONSEFET")," - Fun\xe7\xe3o de acionamento por usu\xe1rio, respons\xe1vel por montar a tela\nde confer\xeancia dos c\xe1lculos antes de aplicar o PBV")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("strong",{parentName:"p"},"QUINTAFEIRA")," - Fun\xe7\xe3o respons\xe1vel por validar se a data de processamento \xe9 uma quinta-feira")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("strong",{parentName:"p"},"U_CV178CSV")," - Fun\xe7\xe3o respons\xe1vel por gerar a planilha de calculo")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("strong",{parentName:"p"},"CV178CSV")," - Fun\xe7\xe3o respons\xe1vel por gerar os dados da planilha de c\xe1lculo.")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("strong",{parentName:"p"},"SELECAOUF")," - Fun\xe7\xe3o respons\xe1vel por gerar a tela de sele\xe7\xe3o de UF's para o processamento.")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("strong",{parentName:"p"},"FLISTBOXUF")," - Fun\xe7\xe3o respons\xe1vel por montar vetor com todas as UF's")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("strong",{parentName:"p"},"U_CV178FIL")," - Fun\xe7\xe3o respons\xe1vel por montar vetor com todas as filiais ativas")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("strong",{parentName:"p"},"MARCAUF")," - Fun\xe7\xe3o respons\xe1vel por marcar ou desmarcar todas as UF's\nna tela de sele\xe7\xe3o de UF's")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("strong",{parentName:"p"},"U_AUTOMCVSK")," - Fun\xe7\xe3o respons\xe1vel por executar o processamento do PBV via schedule")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("strong",{parentName:"p"},"U_ATUMARKBZ")," - Fun\xe7\xe3o respons\xe1vel por atualizar o flag de processamento do markup\nna tabela SBZ")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("strong",{parentName:"p"},"U_INUTNF")," - Fun\xe7\xe3o de acionamento por usu\xe1rio, respons\xe1vel por capturar os par\xe2metros\npara inutilizar uma NF e n\xe3o ser mais usada no processamento do PBV.")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("strong",{parentName:"p"},"U_VLDNFINUT")," - Fun\xe7\xe3o respons\xe1vel por efetivar a inutiliza\xe7\xe3o da NF para os pr\xf3ximos processamentos")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("strong",{parentName:"p"},"U_PERINAD")," - Fun\xe7\xe3o respons\xe1vel por retornar o per\xedodo de processamento\ncadastrado no par\xe2metro ES_FTINAD2")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("strong",{parentName:"p"},"U_XATUCUSTSKCV")," - Fun\xe7\xe3o respons\xe1vel por atualizar o custo CV (Atualmente sem uso).")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("strong",{parentName:"p"},"U_ATUCUSTSKCV")," - Fun\xe7\xe3o respons\xe1vel por efetivar a atualiza\xe7\xe3o do custo CV (Atualmente sem uso).")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("strong",{parentName:"p"},"U_XXCBZSK")," - Fun\xe7\xe3o respons\xe1vel por atualizar BZ_XCUSTOC (Atualmente sem uso).")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("strong",{parentName:"p"},"U_XCBZSK")," - Fun\xe7\xe3o respons\xe1vel por efetivar atualiza\xe7\xe3o BZ_XCUSTOC (atualmente sem uso).")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("strong",{parentName:"p"},"U_REGDESCMAX")," - Fun\xe7\xe3o respons\xe1vel por retornar desconto m\xe1ximo\nconcedido no pedido de vendas."))),(0,o.kt)("hr",null),(0,o.kt)("h2",{id:"novos-campos"},"Novos campos"),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Campos adicionados pelo analista Jonathan - Melhorias")),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"PVB->PVB_CREAL")," - Custo real -> D1_CUSTO/D1_QUANT"),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"PVF->PVF_CREAL")," - Custo real -> D1_CUSTO/D1_QUANT")),(0,o.kt)("p",null,"Ambos os campos s\xe3\xf5 do tipo n\xfamerico, tamanho 16, decimal 2."))}u.isMDXComponent=!0}}]);